<?xml version="1.0" encoding="utf-8" ?>
<toolkit:Popup
    xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
    xmlns:vm="clr-namespace:ICS_Project.App.ViewModels.MusicTrack"
    xmlns:toolkit="http://schemas.microsoft.com/dotnet/2022/maui/toolkit"
    xmlns:models1="clr-namespace:ICS_Project.BL.Models;assembly=ICS_Project.BL"
    x:Class="ICS_Project.App.Views.MusicTrack.Popups.MusicTrackDetailView"
    x:DataType="vm:MusicTrackDetailViewModel"
    Color="Transparent">

    <Frame
        BackgroundColor="{StaticResource Gradient2}"
        BorderColor="{StaticResource Tertiary}"
        CornerRadius="30">

        <Grid
            ColumnDefinitions="auto, *"
            RowDefinitions="Auto, auto, auto, auto, auto, auto"
            ColumnSpacing="10"
            RowSpacing="5">

            <!-- Album Art Section -->
            <Frame
                Grid.Column="0"
                Grid.Row="0"
                Grid.RowSpan="5"
                CornerRadius="30"
                IsClippedToBounds="True"
                BorderColor="{StaticResource Tertiary}"
                BackgroundColor="Transparent"
                Padding="0"
                WidthRequest="180"
                HeightRequest="180"
                Margin="10,10,5,5">
                <Image
                    Source="redhotchilli.png"
                    Aspect="AspectFill"
                    WidthRequest="180"
                    HeightRequest="180" />
            </Frame>

            <!-- Details Section -->
            <Frame
                Grid.Column="1"
                Grid.Row="0"
                Grid.RowSpan="5"
                CornerRadius="30"
                BorderColor="{StaticResource Tertiary}"
                BackgroundColor="{StaticResource SecondaryCardBackgroundColor}"
                Padding="10"
                Margin="0,10,5,5">

                <VerticalStackLayout Spacing="10">
                    <Label
                        FontSize="25"
                        FontAttributes="Bold"
                        TextColor="{StaticResource PrimaryTextColor}"
                        Text="{Binding TrackDetails.Title}"
                        LineBreakMode="TailTruncation" />

                    <!-- Artists -->
                    <Label
                        FontSize="12"
                        TextColor="{StaticResource PrimaryTextColor}"
                        IsVisible="{Binding TrackDetails.Artists.Count, Converter={StaticResource CountToVisibilityConverter}}"
                        LineBreakMode="WordWrap">
                        <!-- Allow wrapping if the line gets too long -->
                        <Label.FormattedText>
                            <FormattedString>
                                <Span Text="Artists: " FontAttributes="Bold" />
                                <Span Text="{Binding ArtistsText}" />
                            </FormattedString>
                        </Label.FormattedText>
                    </Label>

                    <!-- Playlists -->
                    <Label
                        FontSize="12"
                        TextColor="{StaticResource PrimaryTextColor}"
                        IsVisible="{Binding TrackDetails.Playlists.Count, Converter={StaticResource CountToVisibilityConverter}}"
                        LineBreakMode="WordWrap">
                        <Label.FormattedText>
                            <FormattedString>
                                <Span Text="Playlists: " FontAttributes="Bold" />
                                <Span Text="{Binding PlaylistsText}" />
                            </FormattedString>
                        </Label.FormattedText>
                    </Label>

                    <!-- Genres -->
                    <Label
                        FontSize="12"
                        TextColor="{StaticResource PrimaryTextColor}"
                        IsVisible="{Binding TrackDetails.Genres.Count, Converter={StaticResource CountToVisibilityConverter}}"
                        LineBreakMode="WordWrap">
                        <Label.FormattedText>
                            <FormattedString>
                                <Span Text="Genres: " FontAttributes="Bold" />
                                <Span Text="{Binding GenresText}" />
                            </FormattedString>
                        </Label.FormattedText>
                    </Label>

                    <Label
                        FontSize="12"
                        FontAttributes="Bold"
                        TextColor="{StaticResource PrimaryTextColor}">
                        <Label.FormattedText>
                            <FormattedString>
                                <Span Text="Length: " FontAttributes="Bold" />
                                <Span Text="{Binding FormattedLength}" FontAttributes="None" />
                            </FormattedString>
                        </Label.FormattedText>
                        </Label>
                </VerticalStackLayout>
            </Frame>

            <!-- Description Section -->
            <Frame
                Grid.Column="0"
                Grid.ColumnSpan="2"
                Grid.Row="5"
                CornerRadius="15"
                BorderColor="{StaticResource Tertiary}"
                BackgroundColor="{StaticResource CardBackgroundColor}"
                Padding="10"
                Margin="10,5,5,5">
                <Label
                    FontSize="12"
                    FontAttributes="Bold"
                    TextColor="White"
                    Text="{Binding TrackDetails.Description}"
                    LineBreakMode="WordWrap" />
            </Frame>

            <!-- 
            <Button
                Grid.Row="0"
                Grid.Column="1"
                CornerRadius="16"
                WidthRequest="40"
                HeightRequest="40"
                VerticalOptions="Start"
                HorizontalOptions="End"
                BorderWidth="2"
                TextColor="{StaticResource PrimaryTextColor}"
                BackgroundColor="{StaticResource PrimaryButtonColor}"
                Margin="0,15,15,10"
                Padding="1"
                FontSize="15"
                Text="···" /> Options Button -->
        </Grid>
    </Frame>
</toolkit:Popup>